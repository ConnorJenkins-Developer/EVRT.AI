<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
const SUPABASE_URL = "https://YOUR-PROJECT.supabase.co";
const SUPABASE_ANON_KEY = "YOUR_PUBLIC_ANON_KEY";
const REDIRECT = "https://connorjenkins-developer.github.io/evrt-site/app.html";

const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

(async ()=>{
  // Already logged in? Go straight to app
  const { data:{ session } } = await supabase.auth.getSession();
  if (session) { window.location.href = "app.html"; return; }
})();

document.getElementById('login').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const email = document.getElementById('email').value.trim();
  const msg = document.getElementById('msg');
  msg.textContent = "Sending linkâ€¦";
  const { error } = await supabase.auth.signInWithOtp({
    email,
    options: {
      emailRedirectTo: REDIRECT,
      shouldCreateUser: true       // be explicit
    }
  });
  msg.textContent = error ? ("Error: " + error.message) : "Check your email and click the link.";
});
</script>
